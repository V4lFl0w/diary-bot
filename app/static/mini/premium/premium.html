<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Premium</title>

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root{
      /* üé® –¢–£–¢ –ü–û–î–ö–†–£–ß–ò–í–ê–ï–®–¨ –¶–í–ï–¢–ê –ü–û–î –°–í–û–ô –ë–û–¢ */
      --bg: #0b1220;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.08);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.60);

      --brand: #3b82f6;     /* –æ—Å–Ω–æ–≤–Ω–æ–π (—Å–∏–Ω–∏–π) */
      --brand2: #60a5fa;    /* –ø–æ–¥—Å–≤–µ—Ç–∫–∞ */
      --success: #22c55e;
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.14);

      --radius: 18px;
      --radius2: 22px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 520px at 30% -10%, rgba(59,130,246,.25), transparent 55%),
        radial-gradient(900px 420px at 90% 10%, rgba(96,165,250,.18), transparent 55%),
        var(--bg);
      color:var(--text);
      -webkit-font-smoothing: antialiased;
      padding: calc(14px + env(safe-area-inset-top)) 14px calc(18px + env(safe-area-inset-bottom));
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
      gap:10px;
    }
    .title{
      font-size:18px;
      font-weight:700;
      letter-spacing:.2px;
      margin:0;
      line-height:1.2;
    }
    .subtitle{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .pill{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      padding:8px 10px;
      border-radius:999px;
      display:flex;
      align-items:center;
      gap:8px;
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background: var(--brand);
      box-shadow: 0 0 0 4px rgba(59,130,246,.18);
    }

    .tabs{
      display:flex;
      gap:6px;
      background: rgba(255,255,255,.05);
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:6px;
      margin: 14px 0 14px;
    }
    .tab{
      flex:1;
      border:0;
      background: transparent;
      color: var(--muted);
      padding:11px 10px;
      border-radius:999px;
      font-weight:700;
      font-size:14px;
      cursor:pointer;
    }
    .tab.active{
      background: rgba(59,130,246,.22);
      color: var(--text);
      box-shadow: inset 0 0 0 1px rgba(59,130,246,.35);
    }

    .screen{display:none}
    .screen.active{display:block}

    .carousel{
      display:flex;
      gap:12px;
      overflow:auto;
      padding-bottom:6px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }
    .carousel::-webkit-scrollbar{display:none}

    .card{
      min-width: 86%;
      scroll-snap-align: start;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius2);
      padding:14px;
      position:relative;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .card.selected{
      border-color: rgba(96,165,250,.70);
      box-shadow:
        0 12px 34px rgba(0,0,0,.32),
        0 0 0 1px rgba(59,130,246,.35) inset;
      background:
        radial-gradient(900px 280px at 20% 0%, rgba(59,130,246,.22), transparent 60%),
        rgba(255,255,255,.055);
    }

    .badge{
      position:absolute;
      top:12px;
      right:12px;
      background: rgba(59,130,246,.22);
      border:1px solid rgba(59,130,246,.35);
      color: var(--text);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
    }

    .cardHeader{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:12px;
    }

    .planName{
      font-size:22px;
      font-weight:900;
      margin:0;
      letter-spacing:.2px;
    }
    .planDesc{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .check{
      width:28px;height:28px;
      border-radius:999px;
      display:grid;
      place-items:center;
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.04);
      flex: 0 0 auto;
    }
    .card.selected .check{
      border-color: rgba(96,165,250,.8);
      background: rgba(59,130,246,.25);
    }

    .priceRow{
      display:flex;
      align-items:baseline;
      gap:8px;
      margin: 10px 0 12px;
    }
    .price{
      font-size:46px;
      font-weight:950;
      letter-spacing:-.8px;
    }
    .per{
      color:var(--muted);
      font-size:14px;
      font-weight:700;
    }
    .smallLine{
      color:var(--muted);
      font-size:13px;
      margin-top:-6px;
    }

    .gift{
      display:flex;
      align-items:center;
      gap:10px;
      background: rgba(255,255,255,.05);
      border: 1px solid var(--stroke);
      padding:12px;
      border-radius: 14px;
      margin: 14px 0 10px;
    }
    .giftIcon{
      width:32px;height:32px;border-radius:10px;
      display:grid;place-items:center;
      background: rgba(59,130,246,.18);
      border:1px solid rgba(59,130,246,.25);
    }
    .giftText{
      font-weight:800;
    }

    .list{
      margin:10px 0 0;
      padding:0;
      list-style:none;
      display:grid;
      gap:10px;
    }
    .li{
      display:flex;
      align-items:flex-start;
      gap:10px;
      color: rgba(255,255,255,.88);
      font-size:14px;
      line-height:1.35;
    }
    .tick{
      width:18px;height:18px;border-radius:6px;
      background: rgba(34,197,94,.15);
      border:1px solid rgba(34,197,94,.30);
      display:grid;place-items:center;
      color: var(--success);
      margin-top:1px;
      flex: 0 0 auto;
    }

    .footer{
      margin-top: 16px;
      border-top:1px solid rgba(255,255,255,.08);
      padding-top:14px;
    }
    .payMethod{
      color:var(--muted);
      font-size:13px;
      margin: 0 0 10px;
    }

    .btn{
      width:100%;
      border:0;
      cursor:pointer;
      border-radius: 16px;
      padding: 16px 14px;
      font-weight:950;
      font-size:16px;
      color: white;
      background: linear-gradient(90deg, var(--brand), var(--brand2));
      box-shadow: 0 10px 24px rgba(59,130,246,.25);
    }
    .btn:active{ transform: translateY(1px); }

    /* Tokens screen */
    .tokenBox{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius2);
      padding:14px;
    }
    .tokenTitle{
      font-size:18px;font-weight:900;margin:0 0 6px;
    }
    .tokenGrid{
      display:grid;
      gap:10px;
      margin-top:12px;
    }
    .tokenItem{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.045);
      border-radius: 16px;
      padding:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .tokenItem strong{font-size:14px}
    .tokenItem span{color:var(--muted);font-size:13px}
  </style>
</head>

<body>
  <div class="topbar">
    <div>
      <h1 class="title">–ü—Ä–µ–º–∏—É–º</h1>
      <p class="subtitle">–î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –∏–ª–∏ —Ç–æ–∫–µ–Ω—ã.</p>
    </div>
    <div class="pill" id="userPill">
      <span class="dot"></span>
      <span id="userText">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
    </div>
  </div>

  <div class="tabs" role="tablist">
    <button class="tab active" data-tab="sub">–ü–æ–¥–ø–∏—Å–∫–∞</button>
    <button class="tab" data-tab="tok">–¢–æ–∫–µ–Ω—ã</button>
  </div>

  <!-- SUBSCRIPTIONS -->
  <section class="screen active" id="screen-sub">
    <div class="carousel" id="plans"></div>

    <div class="footer">
      <p class="payMethod">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</p>
      <button class="btn" id="payBtn">–û–ø–ª–∞—Ç–∏—Ç—å</button>
    </div>
  </section>

  <!-- TOKENS -->
  <section class="screen" id="screen-tok">
    <div class="tokenBox">
      <h2 class="tokenTitle">–ü–∞–∫–µ—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤</h2>
      <div class="subtitle" style="margin:0;">–¢–æ–∫–µ–Ω—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞ —Ç—è–∂—ë–ª—ã–µ –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).</div>

      <div class="tokenGrid" id="tokenPacks"></div>

      <div class="footer">
        <p class="payMethod">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</p>
        <button class="btn" id="buyTokensBtn">–ö—É–ø–∏—Ç—å —Ç–æ–∫–µ–Ω—ã</button>
      </div>
    </div>
  </section>

  <script>
    // ===== Telegram WebApp init =====
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
      // –ú–æ–∂–Ω–æ –≤–∑—è—Ç—å —Ü–≤–µ—Ç–∞ –∏–∑ Telegram —Ç–µ–º—ã:
      // document.documentElement.style.setProperty('--bg', tg.themeParams.bg_color || '#0b1220');

      const u = tg.initDataUnsafe?.user;
      if (u) {
        document.getElementById('userText').textContent = `${u.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}${u.username ? ' @' + u.username : ''}`;
      }
    }

    // ===== Your structure (–ø–æ–¥ —Ç–≤–æ—é –º–æ–¥–µ–ª—å) =====
    // –í–ê–ñ–ù–û: "id" —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–≤–æ–∏–º–∏ –ø–ª–∞–Ω–∞–º–∏: free/basic/pro
    const PLANS = [
      {
        id: "basic",
        tag: "‚≠ê –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
        name: "–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π",
        desc: "–ï—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –±–æ—Ç–∞ –≤ —Ä–∞–±–æ—Ç–µ –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏.",
        price: 720,
        per: "–º–µ—Å—è—Ü",
        tokensMonthly: 450,
        gift: "45 —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ–¥–∞—Ä–æ–∫",
        bullets: [
          "–î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º",
          "–î–æ 559 –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π",
          "–î–æ 67 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π",
          "–î–æ 15 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –≤–∏–¥–µ–æ*"
        ]
      },
      {
        id: "pro",
        tag: "üöÄ –ú–∞–∫—Å–∏–º—É–º",
        name: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π",
        desc: "–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤—ã–∂–∏–º–∞–µ—Ç –∏–∑ –ò–ò –º–∞–∫—Å–∏–º—É–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.",
        price: 1190,
        per: "–º–µ—Å—è—Ü",
        tokensMonthly: 900,
        gift: "100 —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ–¥–∞—Ä–æ–∫",
        bullets: [
          "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ –æ—á–µ—Ä–µ–¥–∏",
          "–ë–æ–ª—å—à–µ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏",
          "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞",
          "–õ—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–ª–∏–º–∏—Ç—ã"
        ]
      },
      {
        id: "start",
        tag: "",
        name: "–°—Ç–∞—Ä—Ç",
        desc: "–ú–∏–Ω–∏–º—É–º, —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏ –ø–æ–Ω—è—Ç—å –ø–æ—Ç–æ–∫.",
        price: 390,
        per: "–º–µ—Å—è—Ü",
        tokensMonthly: 150,
        gift: "10 —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ–¥–∞—Ä–æ–∫",
        bullets: [
          "–ë–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º",
          "–ù–µ–±–æ–ª—å—à–∏–µ –ª–∏–º–∏—Ç—ã",
          "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–µ–¥–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",
          "–ú–æ–∂–Ω–æ –∞–ø–≥—Ä–µ–π–¥–Ω—É—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç"
        ]
      },
    ];

    const TOKEN_PACKS = [
      { id: "t100", name: "100 —Ç–æ–∫–µ–Ω–æ–≤", price: 199, note: "–ü–æ–¥ –∑–∞–¥–∞—á–∏ –∏–Ω–æ–≥–¥–∞" },
      { id: "t300", name: "300 —Ç–æ–∫–µ–Ω–æ–≤", price: 499, note: "–û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–µ–¥–µ–ª–∏" },
      { id: "t800", name: "800 —Ç–æ–∫–µ–Ω–æ–≤", price: 1099, note: "–î–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã" },
    ];

    let selectedMode = "subscription"; // subscription | tokens
    let selectedPlanId = "basic";
    let selectedTokenPackId = "t300";

    // ===== Render Plans =====
    const plansEl = document.getElementById("plans");
    function renderPlans() {
      plansEl.innerHTML = "";
      for (const p of PLANS) {
        const card = document.createElement("div");
        card.className = "card" + (p.id === selectedPlanId ? " selected" : "");
        card.dataset.plan = p.id;

        card.innerHTML = `
          ${p.tag ? `<div class="badge">${p.tag}</div>` : ""}
          <div class="cardHeader">
            <div>
              <h3 class="planName">${p.name}</h3>
              <p class="planDesc">${p.desc}</p>
            </div>
            <div class="check" aria-label="selected">
              ${p.id === selectedPlanId ? "‚úì" : ""}
            </div>
          </div>

          <div class="priceRow">
            <div class="price">${p.price}‚ÇΩ</div>
            <div class="per">/ ${p.per}</div>
          </div>
          <div class="smallLine">${p.tokensMonthly} —Ç–æ–∫–µ–Ω–æ–≤ –µ–∂–µ–º–µ—Å—è—á–Ω–æ</div>

          <div class="gift">
            <div class="giftIcon">üéÅ</div>
            <div class="giftText">${p.gift}</div>
          </div>

          <ul class="list">
            ${p.bullets.map(x => `
              <li class="li">
                <span class="tick">‚úì</span>
                <span>${x}</span>
              </li>
            `).join("")}
          </ul>
        `;

        card.addEventListener("click", () => {
          selectedPlanId = p.id;
          renderPlans();
          updateButtons();
        });

        plansEl.appendChild(card);
      }
    }

    // ===== Render token packs =====
    const tokenPacksEl = document.getElementById("tokenPacks");
    function renderTokenPacks() {
      tokenPacksEl.innerHTML = "";
      for (const t of TOKEN_PACKS) {
        const item = document.createElement("div");
        item.className = "tokenItem";
        item.style.cursor = "pointer";
        item.style.borderColor = (t.id === selectedTokenPackId) ? "rgba(96,165,250,.55)" : "var(--stroke)";
        item.style.boxShadow = (t.id === selectedTokenPackId) ? "0 0 0 1px rgba(59,130,246,.25) inset" : "none";

        item.innerHTML = `
          <div>
            <strong>${t.name}</strong><br/>
            <span>${t.note}</span>
          </div>
          <div style="text-align:right">
            <strong>${t.price}‚ÇΩ</strong><br/>
            <span>${t.id === selectedTokenPackId ? "–≤—ã–±—Ä–∞–Ω–æ" : "–≤—ã–±—Ä–∞—Ç—å"}</span>
          </div>
        `;

        item.addEventListener("click", () => {
          selectedTokenPackId = t.id;
          renderTokenPacks();
          updateButtons();
        });

        tokenPacksEl.appendChild(item);
      }
    }

    // ===== Tabs logic =====
    const tabs = document.querySelectorAll(".tab");
    const screenSub = document.getElementById("screen-sub");
    const screenTok = document.getElementById("screen-tok");

    tabs.forEach(btn => {
      btn.addEventListener("click", () => {
        tabs.forEach(x => x.classList.remove("active"));
        btn.classList.add("active");

        const tab = btn.dataset.tab;
        if (tab === "sub") {
          selectedMode = "subscription";
          screenSub.classList.add("active");
          screenTok.classList.remove("active");
        } else {
          selectedMode = "tokens";
          screenTok.classList.add("active");
          screenSub.classList.remove("active");
        }
        updateButtons();
      });
    });

    // ===== Actions: send to bot =====
    function sendToBot(payload) {
      // payload –ø–æ–π–¥—ë—Ç –≤ –±–æ—Ç: Telegram.WebApp.onEvent('message') / web_app_data
      const data = JSON.stringify(payload);

      if (tg) {
        tg.sendData(data);
        // –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å:
        // tg.close();
      } else {
        console.log("WebApp payload:", payload);
        alert("DEV MODE:\n" + data);
      }
    }

    const payBtn = document.getElementById("payBtn");
    const buyTokensBtn = document.getElementById("buyTokensBtn");

    function updateButtons() {
      if (selectedMode === "subscription") {
        const plan = PLANS.find(p => p.id === selectedPlanId);
        payBtn.textContent = `–û–ø–ª–∞—Ç–∏—Ç—å ‚Äî ${plan.price}‚ÇΩ`;
      } else {
        const pack = TOKEN_PACKS.find(t => t.id === selectedTokenPackId);
        buyTokensBtn.textContent = `–ö—É–ø–∏—Ç—å ‚Äî ${pack.price}‚ÇΩ`;
      }
    }

    payBtn.addEventListener("click", () => {
      sendToBot({
        action: "buy_subscription",
        plan_id: selectedPlanId,   // "basic" | "pro" | "start"
        source: "webapp"
      });
    });

    buyTokensBtn.addEventListener("click", () => {
      sendToBot({
        action: "buy_tokens",
        pack_id: selectedTokenPackId, // "t100" | "t300" | ...
        source: "webapp"
      });
    });

    // init
    renderPlans();
    renderTokenPacks();
    updateButtons();
  </script>
</body>
</html>